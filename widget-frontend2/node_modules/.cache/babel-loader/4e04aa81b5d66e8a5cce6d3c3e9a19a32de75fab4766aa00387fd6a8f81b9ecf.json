{"ast":null,"code":"// src/App.js\nimport{useState,useEffect,useRef}from'react';import{MantineProvider,Card,Text,Button,TextInput}from'@mantine/core';import axios from'axios';// URL нашего бэкенда\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL='http://localhost:8000/api/hello';const WS_URL='ws://localhost:8000/ws';function App(){const[apiMessage,setApiMessage]=useState('Загрузка данных с бэка...');const[wsMessages,setWsMessages]=useState([]);const[inputValue,setInputValue]=useState('');const socket=useRef(null);// 1. Загружаем данные по HTTP при первом рендере\nuseEffect(()=>{axios.get(API_URL).then(response=>{setApiMessage(response.data.message);}).catch(error=>{setApiMessage('Не удалось загрузить данные :(');console.error(error);});},[]);// 2. Устанавливаем соединение по WebSocket\nuseEffect(()=>{socket.current=new WebSocket(WS_URL);socket.current.onopen=()=>console.log('WebSocket соединение установлено');socket.current.onclose=()=>console.log('WebSocket соединение закрыто');socket.current.onmessage=event=>{setWsMessages(prevMessages=>[...prevMessages,event.data]);};// Закрываем соединение при размонтировании компонента\nreturn()=>{socket.current.close();};},[]);const sendMessage=()=>{if(inputValue&&socket.current.readyState===WebSocket.OPEN){socket.current.send(inputValue);setInputValue('');}};return/*#__PURE__*/_jsxs(Card,{shadow:\"sm\",p:\"lg\",radius:\"md\",withBorder:true,children:[/*#__PURE__*/_jsx(Text,{weight:500,children:\"\\u0422\\u0435\\u0441\\u0442\\u043E\\u0432\\u044B\\u0439 \\u0432\\u0438\\u0434\\u0436\\u0435\\u0442\"}),/*#__PURE__*/_jsxs(Text,{size:\"sm\",color:\"dimmed\",mt:\"md\",children:[\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435 \\u0441 \\u0431\\u044D\\u043A\\u0435\\u043D\\u0434\\u0430 (HTTP): \",/*#__PURE__*/_jsx(\"b\",{children:apiMessage})]}),/*#__PURE__*/_jsx(TextInput,{label:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435 \\u0434\\u043B\\u044F WebSocket\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0442\\u0435\\u043A\\u0441\\u0442...\",value:inputValue,onChange:event=>setInputValue(event.currentTarget.value),mt:\"md\"}),/*#__PURE__*/_jsx(Button,{onClick:sendMessage,mt:\"sm\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E WS\"}),/*#__PURE__*/_jsx(Text,{size:\"sm\",mt:\"lg\",children:\"\\u041E\\u0442\\u0432\\u0435\\u0442\\u044B \\u043E\\u0442 WebSocket:\"}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'100px',overflowY:'auto',border:'1px solid #ccc',padding:'5px',marginTop:'5px'},children:wsMessages.map((msg,index)=>/*#__PURE__*/_jsx(Text,{size:\"xs\",children:msg},index))})]});}// Оборачиваем App в MantineProvider\nexport default function MantineApp(){return/*#__PURE__*/_jsx(MantineProvider,{withGlobalStyles:true,withNormalizeCSS:true,children:/*#__PURE__*/_jsx(App,{})});}","map":{"version":3,"names":["useState","useEffect","useRef","MantineProvider","Card","Text","Button","TextInput","axios","jsx","_jsx","jsxs","_jsxs","API_URL","WS_URL","App","apiMessage","setApiMessage","wsMessages","setWsMessages","inputValue","setInputValue","socket","get","then","response","data","message","catch","error","console","current","WebSocket","onopen","log","onclose","onmessage","event","prevMessages","close","sendMessage","readyState","OPEN","send","shadow","p","radius","withBorder","children","weight","size","color","mt","label","placeholder","value","onChange","currentTarget","onClick","style","maxHeight","overflowY","border","padding","marginTop","map","msg","index","MantineApp","withGlobalStyles","withNormalizeCSS"],"sources":["/Users/ansarzeinulla/Desktop/negro/widget-frontend/src/App.js"],"sourcesContent":["// src/App.js\nimport { useState, useEffect, useRef } from 'react';\nimport { MantineProvider, Card, Text, Button, TextInput } from '@mantine/core';\nimport axios from 'axios';\n\n// URL нашего бэкенда\nconst API_URL = 'http://localhost:8000/api/hello';\nconst WS_URL = 'ws://localhost:8000/ws';\n\nfunction App() {\n  const [apiMessage, setApiMessage] = useState('Загрузка данных с бэка...');\n  const [wsMessages, setWsMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const socket = useRef(null);\n\n  // 1. Загружаем данные по HTTP при первом рендере\n  useEffect(() => {\n    axios.get(API_URL)\n      .then(response => {\n        setApiMessage(response.data.message);\n      })\n      .catch(error => {\n        setApiMessage('Не удалось загрузить данные :(');\n        console.error(error);\n      });\n  }, []);\n\n  // 2. Устанавливаем соединение по WebSocket\n  useEffect(() => {\n    socket.current = new WebSocket(WS_URL);\n\n    socket.current.onopen = () => console.log('WebSocket соединение установлено');\n    socket.current.onclose = () => console.log('WebSocket соединение закрыто');\n\n    socket.current.onmessage = (event) => {\n      setWsMessages(prevMessages => [...prevMessages, event.data]);\n    };\n\n    // Закрываем соединение при размонтировании компонента\n    return () => {\n      socket.current.close();\n    };\n  }, []);\n\n  const sendMessage = () => {\n    if (inputValue && socket.current.readyState === WebSocket.OPEN) {\n      socket.current.send(inputValue);\n      setInputValue('');\n    }\n  };\n\n  return (\n    <Card shadow=\"sm\" p=\"lg\" radius=\"md\" withBorder>\n      <Text weight={500}>Тестовый виджет</Text>\n      <Text size=\"sm\" color=\"dimmed\" mt=\"md\">\n        Сообщение с бэкенда (HTTP): <b>{apiMessage}</b>\n      </Text>\n\n      <TextInput\n        label=\"Сообщение для WebSocket\"\n        placeholder=\"Введите текст...\"\n        value={inputValue}\n        onChange={(event) => setInputValue(event.currentTarget.value)}\n        mt=\"md\"\n      />\n      <Button onClick={sendMessage} mt=\"sm\">\n        Отправить по WS\n      </Button>\n\n      <Text size=\"sm\" mt=\"lg\">Ответы от WebSocket:</Text>\n      <div style={{ maxHeight: '100px', overflowY: 'auto', border: '1px solid #ccc', padding: '5px', marginTop: '5px' }}>\n        {wsMessages.map((msg, index) => (\n          <Text key={index} size=\"xs\">{msg}</Text>\n        ))}\n      </div>\n    </Card>\n  );\n}\n\n// Оборачиваем App в MantineProvider\nexport default function MantineApp() {\n  return (\n    <MantineProvider withGlobalStyles withNormalizeCSS>\n      <App />\n    </MantineProvider>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}